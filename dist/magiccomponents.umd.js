(function(o,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("htmx.org")):typeof define=="function"&&define.amd?define(["exports","htmx.org"],r):(o=typeof globalThis<"u"?globalThis:o||self,r(o.magiccomponents={},o.htmx))})(this,function(o,r){"use strict";var q=Object.defineProperty;var v=(o,r,l)=>r in o?q(o,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):o[r]=l;var y=(o,r,l)=>v(o,typeof r!="symbol"?r+"":r,l);const l=new Map;let g=0;const k=(e,t,s)=>{class n extends HTMLElement{constructor(){super();y(this,"shadow",null);y(this,"stylecontent",null);this.stylecontent=s}connectedCallback(){var h;const u=this.getAttribute("data-key");if(u){const T=`key_${g}`;g++,l.set(T,u)}if(((h=this.parentElement)==null?void 0:h.tagName)==="TEMPLATE")return;const d=w(this);this.hasAttribute("data-shadow")?(this.shadow=this.attachShadow({mode:"open"}),e({element:this.shadow,props:d}),this.addStyle(this.shadow)):e({element:this,props:d})}addStyle(u){if(this.stylecontent){const f=document.createElement("style");f.innerHTML=this.stylecontent,u.appendChild(f)}}disconnectedCallBack(){t&&t({element:this})}}return n},O=(e,t)=>{customElements.get(e)||customElements.define(e,t)},S=e=>{const t=e.reduce((n,i)=>(n[i]=(n[i]||0)+1,n),{});return Object.entries(t).filter(([n,i])=>i>1)},M=e=>{const t=S(e);if(t.length>0)for(const s of t){const[n]=s;throw new Error(`The key '${n}' already exists`)}},$=async({tagname:e,stylecontent:t},s,n=null)=>{const i=k(s,n,t);O(e,i),M([...l.values()])},b=(e,t)=>{const s=location.href,n=Object.fromEntries(new URL(location.toString()).searchParams.entries());let i=`?${new URLSearchParams({...n,...e}).toString()}`,a=location.hash;return t.length>0&&(a=`#${t}`),`${s}${i}${a}`},C=({tagname:e,key:t},s={},n="")=>{const i=b(s,n),a=t?`${e}[data-key='${t}']`:`${e}:nth-child(1 of ${e})`;return document.querySelector(a)===null?Promise.reject("Target not found "):r.ajax("GET",i,{target:a,select:a,swap:"outerHTML"})},w=e=>{var f;const t={...e.dataset},n=Object.entries(t).map(d=>{const[m,h]=d;try{return h?[m,JSON.parse(h)]:[m,h]}catch{return[m,h]}}),i=new Map(n),a=e.querySelector("template");if(a){const d=(f=a==null?void 0:a.content.textContent)==null?void 0:f.trim(),m=d?JSON.parse(d):{};i.set("data",m)}return i.set("tagName",e.tagName.toLowerCase()),Object.fromEntries(i)};let p=0,c=null;const L=async(e,t)=>{var n;if(r.config.refreshOnHistoryMiss===!1)return console.warn("Redirect is not enabled"),!1;const s=document.body;c&&(r.trigger(c,"htmx:abort",{}),(n=c.parentElement)==null||n.remove(),c=null),s.innerHTML+=`<span hx-disinherit="*" class='link-parent'> 
    <a class='bridge-redirect-link' href='${e}' hx-headers='${JSON.stringify(t)}' hx-boost='true' id='bridge-redirect-link-${p}'></a> 
  </span>`,r.process(document.body),c=s.querySelector(`.link-parent>#bridge-redirect-link-${p}`),c==null||c.click(),p++},P=async({redirect:e,loader:t})=>{if(e&&(r.config.refreshOnHistoryMiss=!0),t!=null&&t.enable){await Promise.resolve().then(()=>j);const s=document.createElement("magic-loader");s.setAttribute("data-color",t.color??"#639ef4"),document.body.append(s)}};class E extends HTMLElement{constructor(){super();y(this,"animationOne");y(this,"animationTwo")}connectedCallback(){const s=this.getAttribute("data-color")??"#639ef4";this.style.height="0.2rem",this.style.width="0",this.style.position="fixed",this.style.top="0",this.style.left="0",this.style.zIndex="9999",this.style.backgroundColor=s,this.style.display="none",r.on("htmx:beforeRequest",n=>{var a;const i=n;(a=i==null?void 0:i.detail)!=null&&a.boosted&&(this.style.display="block",this.animationOne=this.animate([{width:0},{width:"88%"}],{duration:7e3,fill:"forwards"}),this.animationOne.addEventListener("finish",()=>{this.animationTwo=this.animate([{width:"88%"},{width:"95%"}],{duration:5e3,iterations:1/0})}))})}disconnectedCallback(){var s,n;this.animationOne&&((s=this.animationOne)==null||s.cancel()),this.animationTwo&&((n=this.animationTwo)==null||n.cancel())}}customElements.define("magic-loader",E);const j=Object.freeze(Object.defineProperty({__proto__:null,MagicLoader:E},Symbol.toStringTag,{value:"Module"}));o.config=P,o.define=$,o.getPath=b,o.getProps=w,o.redirect=L,o.reload=C,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
